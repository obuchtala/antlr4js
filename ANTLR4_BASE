This was written on the basis of the Java core implementation as of version

6d1d0e0488670c5f394f2b1b025f57e5082d9856
